checks for tb_anac_oferta_demanda_aerea:
    # Check fails when hash_key
    # is missing, OR
    # when the data type of those columns is other than specified
    - schema:
        fail:
            when required column missing: [hash_key]
            when wrong column type:
                hash_key: bytes
                empresa_sigla: string
                empresa_nome: string
                empresa_nacionalidade: string
                data_registro: date
                aeroporto_origem_sigla: string
                aeroporto_origem_nome: string
                aeroporto_origem_uf: string
                aeroporto_origem_pais: string
                aeroporto_destino_sigla: string
                aeroporto_destino_nome: string
                aeroporto_destino_uf: string
                aeroporto_destino_pais: string
                natureza_voo: string
                tipo_voo: string
                passageiros_pagos: integer
                passageiros_gratis: integer
                carga_paga_kg: float64
                carga_gratis_kg: float64
                correio_kg: float64
                ask_assentos_ofercidos_km: float64
                rpk_passageiros_transportados_km: float64
                atk_toneladas_ofercidas_km: float64
                rtk_toneladas_transportadas_km: float64
                combustivel_litros: float64
                distancia_voada_km: float64
                decolagens: integer
                carga_paga_km: float64
                carga_gratis_km: float64
                correio_km: float64
                assentos: integer
                capacidade_total_aeronave_kg: float64
                horas_voadas: float64
                bagagem_kg: float64
                ano_particao: date

    - missing_count(aeroporto_origem_sigla):
        name: aeroporto origem sigla não deve conter valores nulos
        warn: when >= 1
    
    - missing_count(aeroporto_origem_pais):
        name: aeroporto origem pais não deve conter valores nulos
        warn: when >= 1

    - duplicate_count(hash_key) = 0:
        name: As linhas devem ser unicas
    
    - invalid_count(passageiros_pagos) = 0:
        name: Coluna passageiros_pagos deve ser maior ou igual a 1
        valid min: 1
    
    - invalid_count(decolagens) = 0:
        name: Coluna decolagens deve ser maior ou igual a 1
        valid min: 1

    - invalid_count(tipo_voo) = 0:
        name: Coluna tipo_voo só deve conter os valores - IMPRODUTIVO, NÃO REGULAR, REGULAR
        valid values: [IMPRODUTIVO, NÃO REGULAR, REGULAR]
    
    - invalid_count(natureza_voo) = 0:
        name: Coluna natureza_voo só deve conter os valores abaixo - INTERNACIONAL, DOMÉSTICA
        valid values: [INTERNACIONAL, DOMÉSTICA]

    - row_count > 0:
        name: Total dever ser maior que 0